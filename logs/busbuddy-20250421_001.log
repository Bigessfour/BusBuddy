2025-04-21 14:42:33.044 -06:00 [INF] Current database schema version: 0
2025-04-21 14:42:33.085 -06:00 [WRN] Migrations directory not found at C:\Users\steve.mckitrick\Desktop\BusBuddy\bin\Debug\net9.0-windows\Migrations. Skipping migration check.
2025-04-21 14:42:35.651 -06:00 [INF] FormFactory: Created instance of VehiclesForm
2025-04-21 14:48:09.325 -06:00 [INF] Applying initialization script from C:\Users\steve.mckitrick\Desktop\BusBuddy\bin\Debug\net9.0-windows\init-db.sql...
2025-04-21 14:48:09.464 -06:00 [INF] Vehicles table already exists. Checking schema...
2025-04-21 14:48:09.550 -06:00 [WRN] Minor error running init script on existing DB (might be expected).
code = Error (1), message = System.Data.SQLite.SQLiteException (0x87AF001F): SQL logic error
table Routes has no column named RouteName
   at System.Data.SQLite.SQLite3.Prepare(SQLiteConnection cnn, SQLiteCommand command, String strSql, SQLiteStatement previous, UInt32 timeoutMS, String& strRemain)
   at System.Data.SQLite.SQLiteCommand.BuildNextCommand()
   at System.Data.SQLite.SQLiteCommand.GetStatement(Int32 index)
   at System.Data.SQLite.SQLiteDataReader.NextResult()
   at System.Data.SQLite.SQLiteDataReader..ctor(SQLiteCommand cmd, CommandBehavior behave)
   at System.Data.SQLite.SQLiteCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SQLite.SQLiteCommand.ExecuteNonQuery(CommandBehavior behavior)
   at System.Data.SQLite.SQLiteCommand.ExecuteNonQuery()
   at Dapper.SqlMapper.ExecuteCommand(IDbConnection cnn, CommandDefinition& command, Action`2 paramReader) in /_/Dapper/SqlMapper.cs:line 2965
   at Dapper.SqlMapper.ExecuteImpl(IDbConnection cnn, CommandDefinition& command) in /_/Dapper/SqlMapper.cs:line 656
   at Dapper.SqlMapper.Execute(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 527
   at BusBuddy.Data.DatabaseManager.<>c__DisplayClass6_0.<InitializeDatabase>b__0(SQLiteConnection connection) in C:\Users\steve.mckitrick\Desktop\BusBuddy\Data\DatabaseManager.cs:line 69
2025-04-21 14:48:09.598 -06:00 [INF] Database schema initialization/verification complete.
2025-04-21 14:48:11.919 -06:00 [INF] FormFactory: Created instance of VehiclesForm
2025-04-21 15:44:05.241 -06:00 [INF] Applying initialization script from C:\Users\steve.mckitrick\Desktop\BusBuddy\bin\Debug\net9.0-windows\init-db.sql...
2025-04-21 15:44:05.388 -06:00 [INF] Vehicles table already exists. Checking schema...
2025-04-21 15:44:05.479 -06:00 [WRN] Minor error running init script on existing DB (might be expected).
code = Error (1), message = System.Data.SQLite.SQLiteException (0x87AF001F): SQL logic error
table Routes has no column named RouteName
   at System.Data.SQLite.SQLite3.Prepare(SQLiteConnection cnn, SQLiteCommand command, String strSql, SQLiteStatement previous, UInt32 timeoutMS, String& strRemain)
   at System.Data.SQLite.SQLiteCommand.BuildNextCommand()
   at System.Data.SQLite.SQLiteCommand.GetStatement(Int32 index)
   at System.Data.SQLite.SQLiteDataReader.NextResult()
   at System.Data.SQLite.SQLiteDataReader..ctor(SQLiteCommand cmd, CommandBehavior behave)
   at System.Data.SQLite.SQLiteCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SQLite.SQLiteCommand.ExecuteNonQuery(CommandBehavior behavior)
   at System.Data.SQLite.SQLiteCommand.ExecuteNonQuery()
   at Dapper.SqlMapper.ExecuteCommand(IDbConnection cnn, CommandDefinition& command, Action`2 paramReader) in /_/Dapper/SqlMapper.cs:line 2965
   at Dapper.SqlMapper.ExecuteImpl(IDbConnection cnn, CommandDefinition& command) in /_/Dapper/SqlMapper.cs:line 656
   at Dapper.SqlMapper.Execute(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 527
   at BusBuddy.Data.DatabaseManager.<>c__DisplayClass6_0.<InitializeDatabase>b__0(SQLiteConnection connection) in C:\Users\steve.mckitrick\Desktop\BusBuddy\Data\DatabaseManager.cs:line 69
2025-04-21 15:44:05.533 -06:00 [INF] Database schema initialization/verification complete.
2025-04-21 15:44:07.629 -06:00 [INF] FormFactory: Created instance of VehiclesForm
2025-04-21 15:44:31.274 -06:00 [INF] FormFactory: Created instance of Welcome
2025-04-21 15:46:46.364 -06:00 [INF] Applying initialization script from C:\Users\steve.mckitrick\Desktop\BusBuddy\bin\Debug\net9.0-windows\init-db.sql...
2025-04-21 15:46:46.500 -06:00 [INF] Vehicles table already exists. Checking schema...
2025-04-21 15:46:46.530 -06:00 [INF] Database schema initialization/verification complete.
2025-04-21 15:46:48.084 -06:00 [INF] FormFactory: Created instance of VehiclesForm
2025-04-21 18:47:01.834 -06:00 [INF] Applying initialization script from C:\Users\steve.mckitrick\Desktop\BusBuddy\bin\Debug\net9.0-windows\init-db.sql...
2025-04-21 18:47:01.984 -06:00 [INF] Vehicles table already exists. Checking schema...
2025-04-21 18:47:02.060 -06:00 [WRN] Minor error running init script on existing DB (might be expected).
code = Error (1), message = System.Data.SQLite.SQLiteException (0x87AF001F): SQL logic error
duplicate column name: PlateNumber
   at System.Data.SQLite.SQLite3.Prepare(SQLiteConnection cnn, SQLiteCommand command, String strSql, SQLiteStatement previous, UInt32 timeoutMS, String& strRemain)
   at System.Data.SQLite.SQLiteCommand.BuildNextCommand()
   at System.Data.SQLite.SQLiteCommand.GetStatement(Int32 index)
   at System.Data.SQLite.SQLiteDataReader.NextResult()
   at System.Data.SQLite.SQLiteDataReader..ctor(SQLiteCommand cmd, CommandBehavior behave)
   at System.Data.SQLite.SQLiteCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SQLite.SQLiteCommand.ExecuteNonQuery(CommandBehavior behavior)
   at System.Data.SQLite.SQLiteCommand.ExecuteNonQuery()
   at Dapper.SqlMapper.ExecuteCommand(IDbConnection cnn, CommandDefinition& command, Action`2 paramReader) in /_/Dapper/SqlMapper.cs:line 2965
   at Dapper.SqlMapper.ExecuteImpl(IDbConnection cnn, CommandDefinition& command) in /_/Dapper/SqlMapper.cs:line 656
   at Dapper.SqlMapper.Execute(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 527
   at BusBuddy.Data.DatabaseManager.<>c__DisplayClass6_0.<InitializeDatabase>b__0(SQLiteConnection connection) in C:\Users\steve.mckitrick\Desktop\BusBuddy\Data\DatabaseManager.cs:line 69
2025-04-21 18:47:02.111 -06:00 [INF] Database schema initialization/verification complete.
2025-04-21 18:47:05.262 -06:00 [INF] FormFactory: Created instance of VehiclesForm
2025-04-21 18:47:09.748 -06:00 [INF] FormFactory: Created instance of Welcome
2025-04-21 18:47:11.342 -06:00 [INF] FormFactory: Created instance of FuelForm
2025-04-21 18:47:32.793 -06:00 [INF] FormFactory: Created instance of MaintenanceForm
2025-04-21 18:47:38.156 -06:00 [INF] FormFactory: Created instance of DriverForm
2025-04-21 18:52:27.207 -06:00 [INF] Applying initialization script from C:\Users\steve.mckitrick\Desktop\BusBuddy\bin\Debug\net9.0-windows\init-db.sql...
2025-04-21 18:52:27.357 -06:00 [INF] Vehicles table already exists. Checking schema...
2025-04-21 18:52:27.442 -06:00 [WRN] Minor error running init script on existing DB (might be expected).
code = Error (1), message = System.Data.SQLite.SQLiteException (0x87AF001F): SQL logic error
duplicate column name: PlateNumber
   at System.Data.SQLite.SQLite3.Prepare(SQLiteConnection cnn, SQLiteCommand command, String strSql, SQLiteStatement previous, UInt32 timeoutMS, String& strRemain)
   at System.Data.SQLite.SQLiteCommand.BuildNextCommand()
   at System.Data.SQLite.SQLiteCommand.GetStatement(Int32 index)
   at System.Data.SQLite.SQLiteDataReader.NextResult()
   at System.Data.SQLite.SQLiteDataReader..ctor(SQLiteCommand cmd, CommandBehavior behave)
   at System.Data.SQLite.SQLiteCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SQLite.SQLiteCommand.ExecuteNonQuery(CommandBehavior behavior)
   at System.Data.SQLite.SQLiteCommand.ExecuteNonQuery()
   at Dapper.SqlMapper.ExecuteCommand(IDbConnection cnn, CommandDefinition& command, Action`2 paramReader) in /_/Dapper/SqlMapper.cs:line 2965
   at Dapper.SqlMapper.ExecuteImpl(IDbConnection cnn, CommandDefinition& command) in /_/Dapper/SqlMapper.cs:line 656
   at Dapper.SqlMapper.Execute(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 527
   at BusBuddy.Data.DatabaseManager.<>c__DisplayClass6_0.<InitializeDatabase>b__0(SQLiteConnection connection) in C:\Users\steve.mckitrick\Desktop\BusBuddy\Data\DatabaseManager.cs:line 69
2025-04-21 18:52:27.490 -06:00 [INF] Database schema initialization/verification complete.
2025-04-21 18:52:30.027 -06:00 [INF] FormFactory: Created instance of VehiclesForm
2025-04-21 18:52:32.482 -06:00 [INF] FormFactory: Created instance of Welcome
2025-04-21 18:52:33.616 -06:00 [INF] FormFactory: Created instance of FuelForm
2025-04-21 18:52:40.043 -06:00 [INF] FormFactory: Created instance of MaintenanceForm
2025-04-21 18:52:45.051 -06:00 [INF] FormFactory: Created instance of DriverForm
2025-04-21 18:54:14.205 -06:00 [INF] Database file found at C:\Users\steve.mckitrick\Desktop\BusBuddy\bin\Debug\net9.0-windows\WileySchool.db. Checking schema version...
2025-04-21 18:54:14.344 -06:00 [INF] Current database schema version: 0
2025-04-21 18:54:14.350 -06:00 [INF] Found 2 pending migrations.
2025-04-21 18:54:14.352 -06:00 [INF] Applying migration 1...
2025-04-21 18:54:14.355 -06:00 [WRN] Migration script for version 1 did not update schema version correctly (Current: 0). Attempting manual update.
2025-04-21 18:54:14.457 -06:00 [ERR] Failed to apply migration 1. Rolling back transaction.
code = Constraint (19), message = System.Data.SQLite.SQLiteException (0x87AF202F): constraint failed
UNIQUE constraint failed: SchemaVersion.Version
   at System.Data.SQLite.SQLite3.Step(SQLiteStatement stmt)
   at System.Data.SQLite.SQLiteDataReader.Step(SQLiteStatement statement)
   at System.Data.SQLite.SQLiteDataReader.NextResult()
   at System.Data.SQLite.SQLiteDataReader..ctor(SQLiteCommand cmd, CommandBehavior behave)
   at System.Data.SQLite.SQLiteCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SQLite.SQLiteCommand.ExecuteNonQuery(CommandBehavior behavior)
   at System.Data.SQLite.SQLiteCommand.ExecuteNonQuery()
   at Dapper.SqlMapper.ExecuteCommand(IDbConnection cnn, CommandDefinition& command, Action`2 paramReader) in /_/Dapper/SqlMapper.cs:line 2965
   at Dapper.SqlMapper.ExecuteImpl(IDbConnection cnn, CommandDefinition& command) in /_/Dapper/SqlMapper.cs:line 656
   at Dapper.SqlMapper.Execute(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 527
   at BusBuddy.Data.DatabaseManager.ApplyPendingMigrations() in C:\Users\steve.mckitrick\Desktop\BusBuddy\Data\DatabaseManager.cs:line 136
2025-04-21 18:54:14.540 -06:00 [FTL] A critical error occurred during database migration application.
code = Constraint (19), message = System.Data.SQLite.SQLiteException (0x87AF202F): constraint failed
UNIQUE constraint failed: SchemaVersion.Version
   at System.Data.SQLite.SQLite3.Step(SQLiteStatement stmt)
   at System.Data.SQLite.SQLiteDataReader.Step(SQLiteStatement statement)
   at System.Data.SQLite.SQLiteDataReader.NextResult()
   at System.Data.SQLite.SQLiteDataReader..ctor(SQLiteCommand cmd, CommandBehavior behave)
   at System.Data.SQLite.SQLiteCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SQLite.SQLiteCommand.ExecuteNonQuery(CommandBehavior behavior)
   at System.Data.SQLite.SQLiteCommand.ExecuteNonQuery()
   at Dapper.SqlMapper.ExecuteCommand(IDbConnection cnn, CommandDefinition& command, Action`2 paramReader) in /_/Dapper/SqlMapper.cs:line 2965
   at Dapper.SqlMapper.ExecuteImpl(IDbConnection cnn, CommandDefinition& command) in /_/Dapper/SqlMapper.cs:line 656
   at Dapper.SqlMapper.Execute(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 527
   at BusBuddy.Data.DatabaseManager.ApplyPendingMigrations() in C:\Users\steve.mckitrick\Desktop\BusBuddy\Data\DatabaseManager.cs:line 136
2025-04-21 18:54:14.577 -06:00 [FTL] A critical error occurred during database initialization or migration.
code = Constraint (19), message = System.Data.SQLite.SQLiteException (0x87AF202F): constraint failed
UNIQUE constraint failed: SchemaVersion.Version
   at System.Data.SQLite.SQLite3.Step(SQLiteStatement stmt)
   at System.Data.SQLite.SQLiteDataReader.Step(SQLiteStatement statement)
   at System.Data.SQLite.SQLiteDataReader.NextResult()
   at System.Data.SQLite.SQLiteDataReader..ctor(SQLiteCommand cmd, CommandBehavior behave)
   at System.Data.SQLite.SQLiteCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SQLite.SQLiteCommand.ExecuteNonQuery(CommandBehavior behavior)
   at System.Data.SQLite.SQLiteCommand.ExecuteNonQuery()
   at Dapper.SqlMapper.ExecuteCommand(IDbConnection cnn, CommandDefinition& command, Action`2 paramReader) in /_/Dapper/SqlMapper.cs:line 2965
   at Dapper.SqlMapper.ExecuteImpl(IDbConnection cnn, CommandDefinition& command) in /_/Dapper/SqlMapper.cs:line 656
   at Dapper.SqlMapper.Execute(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 527
   at BusBuddy.Data.DatabaseManager.ApplyPendingMigrations() in C:\Users\steve.mckitrick\Desktop\BusBuddy\Data\DatabaseManager.cs:line 136
   at BusBuddy.Data.DatabaseManager.InitializeDatabase() in C:\Users\steve.mckitrick\Desktop\BusBuddy\Data\DatabaseManager.cs:line 82
